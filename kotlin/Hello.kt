package sample.helloworld

import rsa.Hex
import rsa.BigInteger
import rsa.RSA


fun hello(): String = "Hello, Kotlin/Native!"

fun main() {
    println("Hello, world!!!")



    val n_inHex = "00A80AE9F02A64BD4836D2FAF9CEF0DC66D44D7E863296F6A711845A641F4411549F8D2962F9CDDD82DBB34272B70CD638E18CA67EA443CF7F84D47927E96A63FD17BA5375F8238EACCEFB54F37FB1C8A59D4C6711409B31CA01F1BC214BB5FE7E4F0E4CF36B6B71126C9C8E265827FE1EF21F1D0A0717072646C88591D04B595B"

    val n_inDecimal = "118003549263062693375791287666410449017472214555119730087655588881551334681315920503765248301772554532055535699874392681585330346760362772867303808873789357313813542961750172992790625516429989064191150102614628170904181779446803473080956247405467532464263463652164118914992900967098132419630680378623866394971"


    val d_inHex = "700746A01C4328DACF3751FBDF4B3D99E2DE5459770F4F1A0BAD919814D80B8DBFB370ECA6893E573D222C4C7A088ED0965DC4546D828A55033850C54646ED524FE28173A1DC51710E3CC5ED00D4B9512EED12C3DDF51F6B18A522C3AE3701DD3BB6B19182D48289B0C31F7A262DA2613402D31C53BD60617A33563725CBF12B"

    val d_inDecimal = "78669032842041795583860858444273632678314809703413153391770392587700889787543947002510165534515036354703690466582928454390220231173575181911535872582526223687552540563125723920693194275108022253621931088830595456680598122755536096707557501311910582550227094544741550787202845024877510921989463465205118529835"

    val e = "3"


    val msg_inHex = "c9"
    val msg_inDecimal = "201"


    val result_endoded_msg_inHex = "7be919"
    val result_endoded_msg_inDecimal = "8120601"



    val endodedInt = RSA.encode(n_inDecimal, e, msg_inDecimal)

    //Algorithm is Okey ?
    val isOkey = if (endodedInt.toString() == result_endoded_msg_inDecimal) "Y" else "N"
    println("Encode Algorithm is Okey ?  $isOkey")


    // Everything above works properlly  --------------------------------------------------------------





    val p = "3457631"
    val q = "3457631"
    val n = BigInteger.multiply(p, q)



    val decodedInt = RSA.decode(n_inDecimal, d_inDecimal, "8")
    println(decodedInt)
    println(Hex.toDecimal(result_endoded_msg_inHex))

}